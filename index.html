<!DOCTYPE html>
<html>
<head>
    <title>My Music App</title>
    <br>
<button onclick="toggleLike()" id="likeBtn">ü§ç Like</button>

<h3>üíö Favourites</h3>
<div id="favList"></div>


<style>
body{
    background:#111;
    color:white;
    text-align:center;
    font-family:Arial;
}

#cover{
    width:220px;
    height:220px;
    border-radius:15px;
    margin-top:20px;
    object-fit:cover;
    box-shadow:0 0 20px #000;
}

.song{
    background:#222;
    padding:12px;
    margin:10px auto;
    width:260px;
    border-radius:10px;
    cursor:pointer;
}

.song:hover{
    background:#444;
}

.active{
    background:#1db954;
    color:black;
    font-weight:bold;
}
</style>
</head>

<body>

<h1>üéµ My Music App</h1>

<img id="cover" src="cover1.jpg">

<h2 id="title">Select a song</h2>

<audio id="player" controls></audio>
<br>

<input type="range" id="progress" value="0" min="0" max="100" style="width:300px">

<div id="time">0:00 / 0:00</div>

<br><br>

<input type="text" id="search" placeholder="Search song..." onkeyup="filterSongs()" style="padding:8px;width:200px">

<div id="playlist" style="margin-top:20px"></div>
<br><br>
<button id="playBtn">‚ñ∂ Play</button>
<br><br>
<button id="shuffleBtn">üîÄ Shuffle Off</button>
<br><br>
<button id="repeatBtn">üîÅ Repeat Off</button>
<br><br>
<input type="range" id="progress" value="0" min="0" step="1" style="width:300px">
<div id="time">0:00 / 0:00</div>
<div>
</div>
<button onclick="prevSong()">‚èÆ Prev</button>
<button onclick="nextSong()">‚è≠ Next</button>
<h3>Playlist</h3>

<div class="song" onclick="playSong(0)">Song 1</div>
<div class="song" onclick="playSong(1)">Song 2</div>
<div class="song" onclick="playSong(2)">Song 3</div>
<div class="song" onclick="playSong(3)">Song 4</div>
<div class="song" onclick="playSong(4)">Song 5</div>
<div class="song" onclick="playSong(5)">Song 6</div>
 
<script>

let player = document.getElementById("player");


let songs = [
 {name:"Song 1", file:"song1.mp3", cover:"cover1.jpg"},
 {name:"Song 2", file:"song2.mp3", cover:"cover2.jpg"},
 {name:"Song 3", file:"song3.mp3", cover:"cover3.jpg"},
 {name:"Song 4", file:"song4.mp3", cover:"cover4.jpg"},
 {name:"Song 5", file:"song5.mp3", cover:"cover5.jpg"},
 {name:"Song 6", file:"song6.mp3", cover:"cover6.jpg"}
];


let current = 0;

// PLAY SONG
function playSong(index){

    current = index;

    player.pause();
    player.src = songs[index].file;
    player.load();
    player.play();

    document.getElementById("title").innerText = songs[index].name;
    document.getElementById("cover").src = songs[index].cover;

    let all = document.querySelectorAll(".song");
    all.forEach(s => s.classList.remove("active"));
    all[index].classList.add("active");
}

// NEXT
function nextSong(){

    if(shuffle){
        current = Math.floor(Math.random() * songs.length);
    }else{
        current++;
        if(current >= songs.length) current = 0;
    }

    playSong(current);
}
// PREVIOUS
function prevSong(){
    current--;
    if(current < 0) current = songs.length - 1;
    playSong(current);
}

// AUTO NEXT
player.onended = function(){

    if(repeat){
        playSong(current);   // same song again
    }else{
        nextSong();          // next / shuffle logic
    }

};


// duration load aana apram
player.onloadedmetadata = function(){
    progress.max = Math.floor(player.duration);
    updateTime();
};

// song odumbothu bar move
player.ontimeupdate = function(){
    progress.value = Math.floor(player.currentTime);
    updateTime();
};

// drag pannina seek
progress.oninput = function(){
    player.currentTime = progress.value;
};

// time format
function updateTime(){
    let cur = format(player.currentTime);
    let dur = format(player.duration);
    time.innerText = cur + " / " + dur;
}

function format(sec){
    if(!sec) return "0:00";
    let m = Math.floor(sec/60);
    let s = Math.floor(sec%60);
    if(s<10) s="0"+s;
    return m+":"+s;
}
let playBtn = document.getElementById("playBtn");

playBtn.onclick = function(){
    if(player.paused){
        player.play();
        playBtn.innerText = "‚è∏ Pause";
    }else{
        player.pause();
        playBtn.innerText = "‚ñ∂ Play";
    }
};

// song play aana button change
player.onplay = () => playBtn.innerText="‚è∏ Pause";
player.onpause = () => playBtn.innerText="‚ñ∂ Play";
let shuffle = false;
let shuffleBtn = document.getElementById("shuffleBtn");

shuffleBtn.onclick = function(){
    shuffle = !shuffle;

    if(shuffle){
        shuffleBtn.innerText = "üîÄ Shuffle On";
    }else{
        shuffleBtn.innerText = "üîÄ Shuffle Off";
    }
};
let repeat = false;
let repeatBtn = document.getElementById("repeatBtn");

repeatBtn.onclick = function(){
    repeat = !repeat;

    if(repeat){
        repeatBtn.innerText = "üîÅ Repeat On";
    }else{
        repeatBtn.innerText = "üîÅ Repeat Off";
    }
};
let playlist = document.getElementById("playlist");

// create list
function renderSongs(list){
    playlist.innerHTML = "";
    list.forEach((song,index)=>{
        let div = document.createElement("div");
        div.innerText = song.name;
        div.style.cursor="pointer";
        div.style.margin="8px";
        div.onclick = ()=> playSong(index);
        playlist.appendChild(div);
    });
}

// search filter
function filterSongs(){
    let text = document.getElementById("search").value.toLowerCase();
    let filtered = songs.filter(s => s.name.toLowerCase().includes(text));
    renderSongs(filtered);
}

// first load
renderSongs(songs);
let progress = document.getElementById("progress");
let time = document.getElementById("time");

// duration load aana apram
player.onloadedmetadata = function(){
    progress.max = Math.floor(player.duration);
    updateTime();
};

// song odumbothu bar move
player.ontimeupdate = function(){
    progress.value = Math.floor(player.currentTime);
    updateTime();
};

// drag pannina seek
progress.oninput = function(){
    player.currentTime = progress.value;
};

// time format
function updateTime(){
    let cur = format(player.currentTime);
    let dur = format(player.duration);
    time.innerText = cur + " / " + dur;
}

function format(sec){
    if(!sec) return "0:00";
    let m = Math.floor(sec/60);
    let s = Math.floor(sec%60);
    if(s<10) s="0"+s;
    return m+":"+s;
}
let favList = document.getElementById("favList");
let likeBtn = document.getElementById("likeBtn");

let favourites = JSON.parse(localStorage.getItem("favs")) || [];

// play song modify (IMPORTANT ‚Äî existing function replace)
function playSong(i){
    current = i;
    player.src = songs[i].file;
    player.load();
    player.play();

    title.innerText = songs[i].name;
    cover.src = songs[i].cover;

    updateLikeBtn();
}

// like toggle
function toggleLike(){
    let songName = songs[current].name;

    if(favourites.includes(songName)){
        favourites = favourites.filter(s => s !== songName);
    }else{
        favourites.push(songName);
    }

    localStorage.setItem("favs", JSON.stringify(favourites));
    updateLikeBtn();
    renderFavs();
}

// change button icon
function updateLikeBtn(){
    if(favourites.includes(songs[current].name))
        likeBtn.innerText = "üíö Liked";
    else
        likeBtn.innerText = "ü§ç Like";
}

// show favourites list
function renderFavs(){
    favList.innerHTML = "";
    favourites.forEach(name=>{
        let div = document.createElement("div");
        div.innerText = name;
        div.style.cursor="pointer";
        div.onclick = ()=>{
            let index = songs.findIndex(s=>s.name===name);
            if(index>=0) playSong(index);
        };
        favList.appendChild(div);
    });
}

// first load
renderFavs();






</script>
</body>
</html>
